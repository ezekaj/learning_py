{% extends "base.html" %}

{% block title %}Progress - Python Learning Program{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Header -->
    <div class="mb-8 animate-fade-in">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white flex items-center">
            📊 Your Progress
        </h1>
        <p class="text-gray-600 dark:text-gray-400 mt-1">
            Track your learning journey and achievements
        </p>
    </div>
    
    <!-- Progress Overview -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <!-- Lessons Progress -->
        <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white animate-slide-up">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <h3 class="text-lg font-semibold">Lessons</h3>
                    <p class="text-blue-100">{{ stats.completed_lessons }}/{{ stats.total_lessons }} completed</p>
                </div>
                <div class="text-3xl">📚</div>
            </div>
            <div class="bg-white bg-opacity-20 rounded-full h-2">
                <div class="bg-white rounded-full h-2 transition-all duration-1000" 
                     style="width: {{ (stats.completed_lessons / stats.total_lessons * 100) if stats.total_lessons > 0 else 0 }}%"></div>
            </div>
        </div>
        
        <!-- Quizzes Progress -->
        <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-6 text-white animate-slide-up" style="animation-delay: 0.1s">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <h3 class="text-lg font-semibold">Quizzes</h3>
                    <p class="text-purple-100">{{ stats.completed_quizzes }}/{{ stats.total_quizzes }} completed</p>
                </div>
                <div class="text-3xl">🧠</div>
            </div>
            <div class="bg-white bg-opacity-20 rounded-full h-2">
                <div class="bg-white rounded-full h-2 transition-all duration-1000" 
                     style="width: {{ (stats.completed_quizzes / stats.total_quizzes * 100) if stats.total_quizzes > 0 else 0 }}%"></div>
            </div>
        </div>
        
        <!-- Challenges Progress -->
        <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white animate-slide-up" style="animation-delay: 0.2s">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <h3 class="text-lg font-semibold">Challenges</h3>
                    <p class="text-green-100">{{ stats.completed_challenges }}/{{ stats.total_challenges }} completed</p>
                </div>
                <div class="text-3xl">🎮</div>
            </div>
            <div class="bg-white bg-opacity-20 rounded-full h-2">
                <div class="bg-white rounded-full h-2 transition-all duration-1000" 
                     style="width: {{ (stats.completed_challenges / stats.total_challenges * 100) if stats.total_challenges > 0 else 0 }}%"></div>
            </div>
        </div>
    </div>
    
    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <!-- Level -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center animate-slide-up">
            <div class="text-3xl mb-2">🏆</div>
            <div class="text-2xl font-bold text-gray-900 dark:text-white">Level {{ stats.level }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Current Level</div>
        </div>
        
        <!-- Points -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center animate-slide-up" style="animation-delay: 0.1s">
            <div class="text-3xl mb-2">⭐</div>
            <div class="text-2xl font-bold text-gray-900 dark:text-white">{{ stats.points }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Total Points</div>
        </div>
        
        <!-- Streak -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center animate-slide-up" style="animation-delay: 0.2s">
            <div class="text-3xl mb-2">🔥</div>
            <div class="text-2xl font-bold text-gray-900 dark:text-white">{{ stats.streak }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Day Streak</div>
        </div>
        
        <!-- Achievements -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center animate-slide-up" style="animation-delay: 0.3s">
            <div class="text-3xl mb-2">🎖️</div>
            <div class="text-2xl font-bold text-gray-900 dark:text-white">{{ stats.achievements|length }}</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Achievements</div>
        </div>
    </div>
    
    <!-- Detailed Progress -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Learning Progress Chart -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 animate-slide-up">
            <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-6">Learning Progress</h2>
            
            <div class="space-y-4">
                <!-- Lessons -->
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">📚 Lessons</span>
                        <span class="text-sm text-gray-500 dark:text-gray-400">{{ stats.completed_lessons }}/{{ stats.total_lessons }}</span>
                    </div>
                    <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                        <div class="bg-blue-500 rounded-full h-3 transition-all duration-1000" 
                             style="width: {{ (stats.completed_lessons / stats.total_lessons * 100) if stats.total_lessons > 0 else 0 }}%"></div>
                    </div>
                </div>
                
                <!-- Quizzes -->
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">🧠 Quizzes</span>
                        <span class="text-sm text-gray-500 dark:text-gray-400">{{ stats.completed_quizzes }}/{{ stats.total_quizzes }}</span>
                    </div>
                    <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                        <div class="bg-purple-500 rounded-full h-3 transition-all duration-1000" 
                             style="width: {{ (stats.completed_quizzes / stats.total_quizzes * 100) if stats.total_quizzes > 0 else 0 }}%"></div>
                    </div>
                </div>
                
                <!-- Challenges -->
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-gray-700 dark:text-gray-300">🎮 Challenges</span>
                        <span class="text-sm text-gray-500 dark:text-gray-400">{{ stats.completed_challenges }}/{{ stats.total_challenges }}</span>
                    </div>
                    <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3">
                        <div class="bg-green-500 rounded-full h-3 transition-all duration-1000" 
                             style="width: {{ (stats.completed_challenges / stats.total_challenges * 100) if stats.total_challenges > 0 else 0 }}%"></div>
                    </div>
                </div>
            </div>
            
            <!-- Overall Progress -->
            <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                <div class="flex justify-between items-center mb-2">
                    <span class="font-medium text-gray-900 dark:text-white">Overall Progress</span>
                    <span class="text-sm text-gray-500 dark:text-gray-400">
                        {{ "%.0f"|format(((stats.completed_lessons + stats.completed_quizzes + stats.completed_challenges) / (stats.total_lessons + stats.total_quizzes + stats.total_challenges) * 100) if (stats.total_lessons + stats.total_quizzes + stats.total_challenges) > 0 else 0) }}%
                    </span>
                </div>
                <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-4">
                    <div class="bg-gradient-to-r from-blue-500 to-purple-500 rounded-full h-4 transition-all duration-1000" 
                         style="width: {{ ((stats.completed_lessons + stats.completed_quizzes + stats.completed_challenges) / (stats.total_lessons + stats.total_quizzes + stats.total_challenges) * 100) if (stats.total_lessons + stats.total_quizzes + stats.total_challenges) > 0 else 0 }}%"></div>
                </div>
            </div>
        </div>
        
        <!-- Leaderboard -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 animate-slide-up">
            <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-6">🏆 Leaderboard</h2>
            
            {% if leaderboard %}
            <div class="space-y-3">
                {% for user in leaderboard %}
                <div class="flex items-center justify-between p-3 {% if loop.index <= 3 %}bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900 dark:to-orange-900{% else %}bg-gray-50 dark:bg-gray-700{% endif %} rounded-lg">
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-3
                                    {% if loop.index == 1 %}bg-yellow-500 text-white
                                    {% elif loop.index == 2 %}bg-gray-400 text-white
                                    {% elif loop.index == 3 %}bg-orange-500 text-white
                                    {% else %}bg-gray-300 text-gray-700{% endif %}">
                            {% if loop.index <= 3 %}
                                {% if loop.index == 1 %}🥇
                                {% elif loop.index == 2 %}🥈
                                {% elif loop.index == 3 %}🥉
                                {% endif %}
                            {% else %}
                                {{ loop.index }}
                            {% endif %}
                        </div>
                        <div>
                            <div class="font-medium text-gray-900 dark:text-white">{{ user.username }}</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Level {{ user.level }}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-gray-900 dark:text-white">{{ user.points }}</div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">points</div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center text-gray-500 dark:text-gray-400 py-8">
                <div class="text-4xl mb-4">👥</div>
                <p>No other learners yet!</p>
                <p class="text-sm">Be the first to complete lessons and climb the leaderboard.</p>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Next Steps -->
    <div class="mt-8 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-700 rounded-xl p-6 animate-slide-up">
        <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center">
            🎯 Next Steps
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            {% if stats.completed_lessons < stats.total_lessons %}
            <a href="{{ url_for('lessons') }}" class="flex items-center p-4 bg-white dark:bg-gray-800 rounded-lg hover:shadow-md transition-shadow">
                <div class="text-2xl mr-3">📚</div>
                <div>
                    <div class="font-medium text-gray-900 dark:text-white">Continue Lessons</div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">{{ stats.total_lessons - stats.completed_lessons }} remaining</div>
                </div>
            </a>
            {% endif %}
            
            {% if stats.completed_quizzes < stats.total_quizzes %}
            <a href="{{ url_for('quizzes') }}" class="flex items-center p-4 bg-white dark:bg-gray-800 rounded-lg hover:shadow-md transition-shadow">
                <div class="text-2xl mr-3">🧠</div>
                <div>
                    <div class="font-medium text-gray-900 dark:text-white">Take Quizzes</div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">{{ stats.total_quizzes - stats.completed_quizzes }} remaining</div>
                </div>
            </a>
            {% endif %}
            
            {% if stats.completed_challenges < stats.total_challenges %}
            <a href="{{ url_for('challenges') }}" class="flex items-center p-4 bg-white dark:bg-gray-800 rounded-lg hover:shadow-md transition-shadow">
                <div class="text-2xl mr-3">🎮</div>
                <div>
                    <div class="font-medium text-gray-900 dark:text-white">Solve Challenges</div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">{{ stats.total_challenges - stats.completed_challenges }} remaining</div>
                </div>
            </a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate progress bars
    const progressBars = document.querySelectorAll('[style*="width:"]');
    progressBars.forEach(bar => {
        const width = bar.style.width;
        bar.style.width = '0%';
        setTimeout(() => {
            bar.style.width = width;
        }, 500);
    });
    
    // Add hover effects to leaderboard items
    const leaderboardItems = document.querySelectorAll('.space-y-3 > div');
    leaderboardItems.forEach(item => {
        item.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.02)';
        });
        
        item.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
        });
    });
});
</script>
{% endblock %}
